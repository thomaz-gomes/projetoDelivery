<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Delivery SaaS ‚Äî Painel</title>

    <!-- ============================ -->
    <!-- üß© Depend√™ncias do QZ Tray -->
    <!-- ============================ -->

    <!-- RSVP (Promise polyfill necess√°rio) -->
    <script src="https://cdn.jsdelivr.net/npm/rsvp@4.8.5/dist/rsvp.min.js"></script>

    <!-- SHA-256 (criptografia usada pelo QZ Tray) -->
    <script src="https://cdn.jsdelivr.net/npm/js-sha256@0.9.0/src/sha256.min.js"></script>

    <!-- Biblioteca principal do QZ Tray -->
    <script src="https://cdn.jsdelivr.net/npm/qz-tray@2.1.0/qz-tray.js"></script>

    <!-- Fallback seguro (em caso de falha de conex√£o) -->
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        if (!window.qz) {
          console.error("‚ùå QZ Tray n√£o carregado. Verifique scripts ou permiss√µes.");
        } else {
          console.log("‚úÖ QZ Tray carregado com sucesso.");
        }

        // Permitir auto-reconex√£o para localhost HTTP (ambiente dev)
        if (window.qz?.security) {
          qz.security.setCertificatePromise((resolve, reject) => {
            // Em dev, usamos o modo sem certificado
            console.warn("‚ö†Ô∏è Usando certificado inseguro (modo DEV).");
            resolve();
          });

          qz.security.setSignaturePromise((toSign) => {
            // Em dev, retorno vazio (sem assinatura)
            return (resolve, reject) => {
              resolve(); // sem assinatura
            };
          });
        }

        // Teste inicial autom√°tico (opcional)
        setTimeout(async () => {
          try {
            if (!qz.websocket.isActive()) {
              await qz.websocket.connect();
              console.log("üñ®Ô∏è QZ Tray conectado!");
            }
          } catch (err) {
            console.warn("‚ö†Ô∏è N√£o foi poss√≠vel conectar ao QZ Tray:", err.message);
          }
        }, 2000);
      });
    </script>

    <!-- ============================ -->
    <!-- ‚öôÔ∏è Estilos do Vue + App -->
    <!-- ============================ -->
    <script type="module" crossorigin src="/src/main.js"></script>
    <link rel="stylesheet" href="/src/assets/main.css" />
  </head>

  <body>
    <div id="app"></div>
  </body>
</html>