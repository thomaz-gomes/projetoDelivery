version: '3.8'
services:
  migrate:
    image: ghcr.io/thomaz-gomes/projetodelivery-backend:latest
    command: sh -c "npx prisma generate && npx prisma migrate deploy"
    environment:
      DATABASE_URL: ${DATABASE_URL}
      NODE_ENV: production
    restart: 'no'
    networks:
      - default

# Usage: docker compose -f deploy/migrate-service-compose.yml up --abort-on-container-exit --exit-code-from migrate
# Ensure DATABASE_URL is exported in your environment or present in a .env file in the working directory.
